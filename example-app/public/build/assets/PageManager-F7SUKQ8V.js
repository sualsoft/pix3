import{r as d,o as M,j as P,k as E,d as e,n as c,c as r,e as v,g as b,b as s,t as u,f,v as p,H as F,F as I,q as U,h as m}from"./app-CT--BO7Q.js";import{_ as z}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-TjZqD5PX.js";const L={class:"min-h-screen w-full bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8"},S={class:"mx-auto max-w-6xl"},$={class:"flex items-center justify-between bg-gradient-to-r from-blue-700 to-indigo-800 p-6 text-white"},B={class:"flex items-center gap-2 text-2xl font-bold"},N={key:0,class:"fa-solid fa-pen-to-square"},q={key:1,class:"fa-solid fa-plus-circle"},A={class:"space-y-6 p-6 md:p-8"},G={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},R={class:"flex gap-2"},H={class:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg border border-blue-200 bg-blue-50 text-xl text-blue-600 shadow-sm"},Y={class:"md:col-span-2"},J={class:"flex flex-col items-start gap-6 md:flex-row"},K={class:"group relative flex aspect-video w-full items-center justify-center overflow-hidden rounded-lg border-2 border-dashed border-gray-300 bg-gray-100 md:w-1/3"},O=["src"],Q={key:1,class:"p-4 text-center text-gray-400"},W={class:"w-full flex-1"},X={key:0,class:"mb-2 text-sm text-gray-600"},Z={class:"flex items-center justify-end gap-4 border-t border-gray-200 pt-6"},ee=["disabled"],te={key:0,class:"fa-solid fa-spinner animate-spin"},le={class:"mb-6 flex items-center gap-2 text-2xl font-bold text-gray-900"},oe={class:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3"},ae={class:"relative h-48 overflow-hidden bg-gray-100"},se=["src"],re={class:"p-5"},ie={class:"mb-3 flex items-start gap-4"},ne={class:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-xl border border-blue-100 bg-gradient-to-br from-blue-50 to-indigo-50 text-xl text-blue-600 shadow-sm"},de={class:"mb-1 text-lg leading-tight font-bold text-gray-900"},ue={class:"inline-block rounded bg-gray-100 px-1 font-mono text-xs text-gray-500"},ce={class:"mt-4 flex gap-2 border-t border-gray-100 pt-4"},ge=["onClick"],be=["onClick"],me={__name:"PageManager",setup(fe){const x=d([]),n=d(""),g=d(!1),i=d(!1),h=d(null),y=d(null),l=d({title:"",category:"timelapse",icon:"fa-solid fa-camera",video_url:"",content:"",thumbnail:null,thumbnail_preview:null}),_=async()=>{try{const o=await m.get("/api/service-pages");x.value=o.data}catch(o){console.error(o)}},C=o=>{const t=o.target.files[0];if(t){l.value.thumbnail=t;const a=new FileReader;a.onload=w=>l.value.thumbnail_preview=w.target.result,a.readAsDataURL(t)}},j=o=>{i.value=!0,h.value=o.id,l.value.title=o.title,l.value.category=o.category,l.value.icon=o.icon||"fa-solid fa-camera",l.value.video_url=o.video_url,l.value.content=o.content,l.value.thumbnail_preview=o.thumbnail,l.value.thumbnail=null,y.value&&y.value.scrollIntoView({behavior:"smooth",block:"start"})},k=()=>{i.value=!1,h.value=null,T()},T=()=>{l.value={title:"",category:"timelapse",icon:"fa-solid fa-camera",video_url:"",content:"",thumbnail:null,thumbnail_preview:null}},V=async()=>{g.value=!0,n.value="";const o=new FormData;o.append("title",l.value.title),o.append("category",l.value.category),o.append("icon",l.value.icon),o.append("content",l.value.content),l.value.video_url&&o.append("video_url",l.value.video_url),l.value.thumbnail&&o.append("thumbnail",l.value.thumbnail);try{i.value?(await m.post(`/api/service-pages/${h.value}`,o,{headers:{"Content-Type":"multipart/form-data"}}),n.value="✅ Page mise à jour !"):(await m.post("/api/service-pages",o,{headers:{"Content-Type":"multipart/form-data"}}),n.value="✅ Page créée !"),k(),_()}catch(t){n.value="❌ Erreur de sauvegarde.",console.error(t)}finally{g.value=!1}},D=async o=>{if(confirm("Supprimer cette page ?"))try{await m.delete(`/api/service-pages/${o}`),_()}catch{alert("Erreur")}};return M(()=>_()),(o,t)=>(s(),P(z,null,{default:E(()=>[e("div",L,[e("div",S,[e("div",{class:"mb-8 text-center",ref_key:"formTop",ref:y},[...t[5]||(t[5]=[e("h1",{class:"text-3xl font-bold text-gray-900"}," Gestionnaire de Pages ",-1),e("p",{class:"mt-2 text-gray-700"}," Gérez vos services Drone et Timelapse. ",-1)])],512),e("div",{class:c(["mb-12 overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-xl transition-all duration-500",i.value?"scale-[1.01] transform ring-4 ring-blue-300":""])},[e("div",$,[e("h2",B,[i.value?(s(),r("i",N)):(s(),r("i",q)),b(" "+u(i.value?"Modifier la Page":"Nouvelle Page"),1)]),i.value?(s(),r("button",{key:0,onClick:k,class:"rounded-full bg-white/20 px-4 py-2 text-sm font-semibold backdrop-blur-sm transition hover:bg-white/30"}," Annuler l'édition ")):v("",!0)]),e("div",A,[e("div",G,[e("div",null,[t[6]||(t[6]=e("label",{class:"mb-2 block text-sm font-bold text-gray-800"},"Titre de la page",-1)),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.title=a),type:"text",placeholder:"ex: Suivi de Chantier",class:"w-full rounded-lg border-2 border-gray-300 p-3 font-medium text-gray-900 transition focus:border-blue-600"},null,512),[[p,l.value.title]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"mb-2 block text-sm font-bold text-gray-800"},"Catégorie",-1)),f(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.category=a),class:"w-full rounded-lg border-2 border-gray-300 bg-white p-3 font-medium text-gray-900 transition focus:border-blue-600"},[...t[7]||(t[7]=[e("option",{value:"timelapse"},"Timelapse",-1),e("option",{value:"drone"},"Drone",-1)])],512),[[F,l.value.category]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"mb-2 block text-sm font-bold text-gray-800"},"Icône",-1)),e("div",R,[e("div",H,[e("i",{class:c(l.value.icon)},null,2)]),f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.icon=a),type:"text",placeholder:"ex: fa-solid fa-camera",class:"w-full rounded-lg border-2 border-gray-300 p-3 font-medium text-gray-900 transition focus:border-blue-600"},null,512),[[p,l.value.icon]])])]),e("div",null,[t[10]||(t[10]=e("label",{class:"mb-2 block text-sm font-bold text-gray-800"},"Lien YouTube",-1)),f(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.video_url=a),type:"text",placeholder:"https://youtube.com/...",class:"w-full rounded-lg border-2 border-gray-300 p-3 font-medium text-gray-900 transition focus:border-blue-600"},null,512),[[p,l.value.video_url]])]),e("div",Y,[t[12]||(t[12]=e("label",{class:"mb-2 block text-sm font-bold text-gray-800"},"Image de couverture",-1)),e("div",J,[e("div",K,[l.value.thumbnail_preview?(s(),r("img",{key:0,src:l.value.thumbnail_preview,class:"h-full w-full object-cover transition duration-300 group-hover:scale-105"},null,8,O)):(s(),r("div",Q,[...t[11]||(t[11]=[e("i",{class:"fa-regular fa-image mb-2 text-3xl"},null,-1),e("p",{class:"text-xs"},"Aucune image",-1)])]))]),e("div",W,[i.value?(s(),r("p",X," L'image actuelle est affichée à gauche. Téléchargez-en une nouvelle seulement si vous souhaitez la remplacer. ")):v("",!0),e("input",{type:"file",onChange:C,accept:"image/*",class:"w-full rounded-lg border-2 border-gray-300 bg-white p-3 text-gray-700 file:mr-4 file:rounded-full file:border-0 file:bg-blue-50 file:px-4 file:py-2 file:text-sm file:font-bold file:text-blue-700 hover:file:bg-blue-100"},null,32)])])])]),e("div",null,[t[13]||(t[13]=e("label",{class:"mb-2 block text-sm font-bold text-gray-800"},"Contenu de la page",-1)),f(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.content=a),rows:"8",class:"w-full rounded-lg border-2 border-gray-300 p-3 text-sm font-medium text-gray-900 focus:border-blue-600",placeholder:"Écrivez votre texte ici..."},null,512),[[p,l.value.content]])]),e("div",Z,[n.value?(s(),r("span",{key:0,class:c(["animate-pulse text-lg font-bold",n.value.includes("✅")?"text-green-600":"text-red-600"])},u(n.value),3)):v("",!0),e("button",{onClick:V,disabled:g.value,class:"flex transform items-center gap-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-700 px-8 py-3 font-bold text-white shadow-lg transition hover:scale-105 hover:from-blue-700 hover:to-indigo-800 disabled:scale-100 disabled:opacity-70"},[g.value?(s(),r("i",te)):v("",!0),b(" "+u(g.value?"Sauvegarde...":i.value?"Mettre à jour":"Créer la page"),1)],8,ee)])])],2),e("div",null,[e("h3",le,[t[14]||(t[14]=e("i",{class:"fa-solid fa-layer-group text-blue-600"},null,-1)),b(" Pages Existantes ("+u(x.value.length)+") ",1)]),e("div",oe,[(s(!0),r(I,null,U(x.value,a=>(s(),r("div",{key:a.id,class:"group overflow-hidden rounded-xl border border-gray-200 bg-white shadow-md transition-all duration-300 hover:shadow-xl"},[e("div",ae,[e("img",{src:a.thumbnail||"/images/hero-bg-1765171683.png",class:"h-full w-full object-cover transition duration-500 group-hover:scale-110"},null,8,se),t[15]||(t[15]=e("div",{class:"absolute inset-x-0 top-0 h-16 bg-gradient-to-b from-black/50 to-transparent"},null,-1)),e("div",{class:c(["absolute top-3 right-3 flex items-center gap-1 rounded-full bg-white/90 px-3 py-1 text-xs font-bold uppercase shadow-sm backdrop-blur",a.category==="drone"?"text-purple-700":"text-blue-700"])},[e("i",{class:c(a.category==="drone"?"fa-solid fa-plane-up":"fa-solid fa-clock")},null,2),b(" "+u(a.category),1)],2)]),e("div",re,[e("div",ie,[e("div",ne,[e("i",{class:c(a.icon||"fa-solid fa-camera")},null,2)]),e("div",null,[e("h4",de,u(a.title),1),e("p",ue," /"+u(a.slug),1)])]),e("div",ce,[e("button",{onClick:w=>j(a),class:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-blue-50 py-2.5 font-bold text-blue-700 transition hover:bg-blue-100"},[...t[16]||(t[16]=[e("i",{class:"fa-solid fa-pen-to-square"},null,-1),b(" Modifier ",-1)])],8,ge),e("button",{onClick:w=>D(a.id),class:"rounded-lg bg-red-50 px-4 py-2.5 font-bold text-red-600 transition hover:bg-red-100"},[...t[17]||(t[17]=[e("i",{class:"fa-solid fa-trash"},null,-1)])],8,be)])])]))),128))])])])])]),_:1}))}};export{me as default};
