import{r as b,o as F,j as O,k as V,l as U,d as e,u as A,m as R,c as v,e as w,f as i,b as g,n as _,t as m,v as f,B as q,D as C,F as $,q as B,H as I}from"./app-DeuKnPJx.js";import{_ as K}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BR4GEVq0.js";const P={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},L={class:"mb-6 border-b border-gray-200"},X={class:"-mb-px flex space-x-8"},J={class:"space-y-6"},z={class:"overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-xl"},H={class:"p-6 md:p-8"},Y={class:"space-y-6"},W={class:"mb-4 flex items-center"},G={class:"flex justify-end space-x-3"},Q=["disabled"],Z=["disabled"],ee=["disabled"],te={class:"space-y-6"},oe={class:"overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-xl"},ae={class:"p-6 md:p-8"},ne={key:0,class:"space-y-4"},se={class:"flex justify-between"},le={class:"font-bold text-gray-900"},re={class:"text-sm text-gray-600 capitalize"},ie={class:"mt-1 text-xs text-gray-500"},de={class:"text-right"},ue={key:0,class:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800"},ce=["onClick"],me={key:0,class:"mt-3"},pe=["src","alt"],ge={key:1,class:"py-8 text-center text-gray-500"},be={class:"space-y-6"},ve={class:"overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-xl"},fe={class:"p-6 md:p-8"},ye={class:"space-y-6"},xe={key:0},he={class:"mb-1 block text-sm font-medium text-gray-700"},we={class:"space-y-3"},_e={class:"flex justify-end"},ke=["disabled"],Te={__name:"MainContent",setup(Ce){const d=b({client_name:"",title:""}),s=b({name:"",type:"video",date:"",badge:"",youtube_id:"",thumbnail_file:null,download_file:null,external_link:""}),h=b({reset_content:!1});b({use_as_template:!1});const k=b([]),a=b(""),l=b(!1),p=b("content"),y=async()=>{try{const t=await(await fetch("/api/dashboard/main-content")).json();t&&(d.value.client_name=t.client_name||"",d.value.title=t.title||"",k.value=t.files||[])}catch(n){console.error("Error loading main content",n),a.value="❌ Error loading content: "+n.message}},S=async()=>{l.value=!0,a.value="";try{const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),t=await fetch("/api/dashboard/main-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify(d.value)});let o={};try{o=await t.json()}catch{o.message=await t.text()}if(t.ok)a.value="✅ Main content updated successfully!";else if(o.errors){const r=Object.values(o.errors).flat().join(", ");a.value="❌ Validation Error: "+r}else a.value="❌ Error: "+(o.message||"Failed to update content")}catch(n){a.value="❌ Network error: "+n.message,console.error("Update error",n)}finally{l.value=!1}},j=async()=>{l.value=!0,a.value="";try{const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),t=new FormData;t.append("name",s.value.name),t.append("type",s.value.type),t.append("date",s.value.date),t.append("badge",s.value.badge),t.append("youtube_id",s.value.youtube_id),s.value.thumbnail_file&&t.append("thumbnail_file",s.value.thumbnail_file),s.value.download_file&&t.append("download_file",s.value.download_file),s.value.external_link&&t.append("external_link",s.value.external_link);const o=await fetch("/api/dashboard/main-section",{method:"POST",headers:{"X-CSRF-TOKEN":n},body:t});let r={};try{r=await o.json()}catch{r.message=await o.text()}if(o.ok)a.value="✅ New section added successfully!",s.value={name:"",type:"video",date:"",badge:"",youtube_id:"",thumbnail_file:null,download_file:null,external_link:""},y();else if(r.errors){const u=Object.values(r.errors).flat().join(", ");a.value="❌ Validation Error: "+u}else a.value="❌ Error: "+(r.message||"Failed to add section")}catch(n){a.value="❌ Network error: "+n.message,console.error("Add section error",n)}finally{l.value=!1}},T=n=>{s.value.thumbnail_file=n.target.files[0]},E=n=>{s.value.download_file=n.target.files[0]},N=async n=>{if(confirm("Are you sure you want to delete this section?")){l.value=!0,a.value="";try{const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),o=await fetch(`/api/user-project/file/${n}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":t}});let r={};try{r=await o.json()}catch{r.message=await o.text()}o.ok?(a.value="✅ Section deleted successfully!",y()):a.value="❌ Error: "+(r.message||"Failed to delete section")}catch(t){a.value="❌ Network error: "+t.message,console.error("Delete error",t)}finally{l.value=!1}}};F(()=>{y()});const D=async()=>{l.value=!0,a.value="";try{const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),o=await(await fetch("/api/dashboard/main-content")).json();if(!o||!o.id){a.value="❌ Error: Could not find main project";return}const r={client_name:d.value.client_name,title:d.value.title,slug:"main-dashboard",reset_content:h.value.reset_content},u=await fetch(`/api/user-project/${o.id}/refresh`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify(r)});let c={};try{c=await u.json()}catch{c.message=await u.text()}if(u.ok)a.value="✅ Main content refreshed successfully!",h.value.reset_content&&y();else if(c.errors){const x=Object.values(c.errors).flat().join(", ");a.value="❌ Validation Error: "+x}else a.value="❌ Error: "+(c.message||"Failed to refresh content")}catch(n){a.value="❌ Network error: "+n.message,console.error("Refresh error",n)}finally{l.value=!1}},M=async()=>{l.value=!0,a.value="";try{const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),o=await(await fetch("/api/dashboard/main-content")).json();if(!o||!o.id){a.value="❌ Error: Could not find main project";return}const r={client_name:d.value.client_name+" (Copy)",title:d.value.title+" (Copy)",slug:"new-page-"+Date.now(),template_page_id:o.id},u=await fetch("/api/user-project/template",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify(r)});let c={};try{c=await u.json()}catch{c.message=await u.text()}if(u.ok)a.value="✅ New page created successfully from current content!",y();else if(c.errors){const x=Object.values(c.errors).flat().join(", ");a.value="❌ Validation Error: "+x}else a.value="❌ Error: "+(c.message||"Failed to create page from template")}catch(n){a.value="❌ Network error: "+n.message,console.error("Template creation error",n)}finally{l.value=!1}};return(n,t)=>(g(),O(K,null,{default:V(()=>[U(A(R),{title:"Main Dashboard Content"}),e("div",P,[t[29]||(t[29]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"}," Main Dashboard Content "),e("p",{class:"mt-2 text-gray-600"}," Manage your main dashboard page content ")],-1)),a.value?(g(),v("div",{key:0,class:_(["mb-6 rounded-lg p-4",{"bg-green-100 text-green-800":a.value.includes("✅"),"bg-red-100 text-red-800":a.value.includes("❌")}])},m(a.value),3)):w("",!0),e("div",L,[e("nav",X,[e("button",{onClick:t[0]||(t[0]=o=>p.value="content"),class:_([p.value==="content"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700","border-b-2 px-1 py-4 text-sm font-medium whitespace-nowrap"])}," Main Content ",2),e("button",{onClick:t[1]||(t[1]=o=>p.value="sections"),class:_([p.value==="sections"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700","border-b-2 px-1 py-4 text-sm font-medium whitespace-nowrap"])}," Content Sections ",2),e("button",{onClick:t[2]||(t[2]=o=>p.value="add"),class:_([p.value==="add"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700","border-b-2 px-1 py-4 text-sm font-medium whitespace-nowrap"])}," Add New Section ",2)])]),i(e("div",J,[e("div",z,[t[15]||(t[15]=e("div",{class:"bg-gradient-to-r from-indigo-600 to-purple-700 p-6 text-white"},[e("h2",{class:"text-2xl font-bold"}," Main Page Information ")],-1)),e("div",H,[e("div",Y,[e("div",null,[t[12]||(t[12]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Client Name",-1)),i(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>d.value.client_name=o),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"Enter client name"},null,512),[[f,d.value.client_name]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Page Title",-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>d.value.title=o),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"Enter page title"},null,512),[[f,d.value.title]])]),e("div",W,[i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>h.value.reset_content=o),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[q,h.value.reset_content]]),t[14]||(t[14]=e("label",{class:"ml-2 block text-sm text-gray-700"}," Clear all existing content when saving ",-1))]),e("div",G,[e("button",{onClick:S,disabled:l.value,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50"},m(l.value?"Saving...":"Save Changes"),9,Q),e("button",{onClick:D,disabled:l.value,class:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"},m(l.value?"Refreshing...":"Refresh Content"),9,Z),e("button",{onClick:M,disabled:l.value,class:"rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700 disabled:opacity-50"},m(l.value?"Creating...":"Use as Template"),9,ee)])])])])],512),[[C,p.value==="content"]]),i(e("div",te,[e("div",oe,[t[17]||(t[17]=e("div",{class:"bg-gradient-to-r from-indigo-600 to-purple-700 p-6 text-white"},[e("h2",{class:"text-2xl font-bold"},"Content Sections"),e("p",{class:"mt-1 text-indigo-100"}," Manage existing content sections ")],-1)),e("div",ae,[k.value.length>0?(g(),v("div",ne,[(g(!0),v($,null,B(k.value,o=>(g(),v("div",{key:o.id,class:"rounded-lg border border-gray-200 p-4"},[e("div",se,[e("div",null,[e("h3",le,m(o.name),1),e("p",re,m(o.type),1),e("p",ie,m(o.date),1)]),e("div",de,[o.badge?(g(),v("span",ue,m(o.badge),1)):w("",!0),e("button",{onClick:r=>N(o.id),class:"ml-4 text-sm text-red-600 hover:text-red-800"}," Delete ",8,ce)])]),o.thumbnail?(g(),v("div",me,[e("img",{src:o.thumbnail,alt:o.name,class:"h-20 w-20 rounded object-cover"},null,8,pe)])):w("",!0)]))),128))])):(g(),v("div",ge,[...t[16]||(t[16]=[e("p",null,"No content sections found.",-1),e("p",{class:"mt-2 text-sm"},' Add your first section using the "Add New Section" tab. ',-1)])]))])])],512),[[C,p.value==="sections"]]),i(e("div",be,[e("div",ve,[t[28]||(t[28]=e("div",{class:"bg-gradient-to-r from-indigo-600 to-purple-700 p-6 text-white"},[e("h2",{class:"text-2xl font-bold"}," Add New Content Section "),e("p",{class:"mt-1 text-indigo-100"}," Create a new section for your dashboard ")],-1)),e("div",fe,[e("div",ye,[e("div",null,[t[18]||(t[18]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Section Name *",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>s.value.name=o),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"Enter section name",required:""},null,512),[[f,s.value.name]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Type *",-1)),i(e("select",{"onUpdate:modelValue":t[7]||(t[7]=o=>s.value.type=o),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none"},[...t[19]||(t[19]=[e("option",{value:"video"},"Video",-1),e("option",{value:"image"},"Image",-1),e("option",{value:"document"},"Document",-1)])],512),[[I,s.value.type]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Date *",-1)),i(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>s.value.date=o),type:"date",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",required:""},null,512),[[f,s.value.date]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Badge",-1)),i(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>s.value.badge=o),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"e.g., NEW, 4K, HD"},null,512),[[f,s.value.badge]])]),s.value.type==="video"?(g(),v("div",xe,[t[23]||(t[23]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"YouTube ID",-1)),i(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>s.value.youtube_id=o),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"Enter YouTube video ID"},null,512),[[f,s.value.youtube_id]])])):w("",!0),e("div",null,[t[24]||(t[24]=e("label",{class:"mb-1 block text-sm font-medium text-gray-700"},"Thumbnail Image",-1)),e("input",{type:"file",accept:"image/*",onChange:T,class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none"},null,32)]),e("div",null,[e("label",he,m(s.value.type==="video"?"Video File or Link":s.value.type==="image"?"Image File":"Document File"),1),e("div",we,[e("div",null,[t[25]||(t[25]=e("label",{class:"mb-1 block text-xs text-gray-500"},"Upload File",-1)),e("input",{type:"file",onChange:E,class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none"},null,32)]),t[27]||(t[27]=e("div",{class:"relative"},[e("div",{class:"absolute inset-0 flex items-center"},[e("div",{class:"w-full border-t border-gray-300"})]),e("div",{class:"relative flex justify-center text-sm"},[e("span",{class:"bg-white px-2 text-gray-500"},"OR")])],-1)),e("div",null,[t[26]||(t[26]=e("label",{class:"mb-1 block text-xs text-gray-500"},"External Link",-1)),i(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>s.value.external_link=o),type:"url",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-indigo-500 focus:outline-none",placeholder:"https://example.com/file"},null,512),[[f,s.value.external_link]])])])]),e("div",_e,[e("button",{onClick:j,disabled:l.value,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50"},m(l.value?"Adding...":"Add Section"),9,ke)])])])])],512),[[C,p.value==="add"]])])]),_:1}))}};export{Te as default};
