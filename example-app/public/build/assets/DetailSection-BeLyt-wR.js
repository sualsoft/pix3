import{r as g,o as C,j as D,k as I,d as t,f,v as b,c as n,e as p,b as o,F as L,q as $,t as v,n as j,h}from"./app-BPnb9YoN.js";import{_ as F}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DBXsMluo.js";const S={class:"min-h-screen w-full bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8"},z={class:"mx-auto max-w-5xl"},B={class:"overflow-hidden rounded-2xl bg-white shadow-xl"},E={class:"space-y-6 p-8"},M={class:"mb-4 flex items-center justify-between"},T={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},V={class:"group relative h-40 overflow-hidden rounded-lg border bg-gray-100"},A=["src"],U={key:1,class:"flex h-full items-center justify-center text-gray-400"},q=["onClick"],N={class:"flex gap-2"},R=["onChange"],W=["onClick"],P={class:"text-xs font-bold text-gray-500"},Q={class:"flex items-center justify-end gap-4 border-t pt-6"},G=["disabled"],O={__name:"DetailSection",setup(H){const l=g({title:"",description:"",images:["","",""]}),r=g(""),c=g(!1),d=g([null,null,null]),m=async()=>{try{const a=await h.get("/api/layout");if(a.data.timelapse_detail)for(l.value=a.data.timelapse_detail;l.value.images.length<3;)l.value.images.push("")}catch(a){console.error(a)}},x=(a,e)=>{const s=a.target.files[0];if(s){d.value[e]=s;const i=new FileReader;i.onload=u=>l.value.images[e]=u.target.result,i.readAsDataURL(s)}},y=a=>{l.value.images[a]="",d.value[a]=null},w=()=>{l.value.images.length<6&&(l.value.images.push(""),d.value.push(null))},_=a=>{l.value.images.length>1&&(l.value.images.splice(a,1),d.value.splice(a,1))},k=async()=>{c.value=!0,r.value="";try{const a=new FormData;a.append("title",l.value.title||""),a.append("description",l.value.description||"");for(let e=0;e<l.value.images.length;e++)d.value[e]?a.append(`images[${e}]`,d.value[e]):l.value.images[e]&&l.value.images[e].startsWith("http")?a.append(`images[${e}]`,l.value.images[e]):l.value.images[e]&&l.value.images[e].startsWith("/images/")?a.append(`images[${e}]`,l.value.images[e]):a.append(`images[${e}]`,"");await h.post("/api/settings/timelapse-detail",a,{headers:{"Content-Type":"multipart/form-data"}}),r.value="✅ Détails sauvegardés !",await m()}catch(a){console.error(a),r.value="❌ Erreur lors de la sauvegarde."}finally{c.value=!1}};return C(()=>m()),(a,e)=>(o(),D(F,null,{default:I(()=>[t("div",S,[t("div",z,[e[7]||(e[7]=t("div",{class:"mb-8 text-center"},[t("h1",{class:"text-3xl font-bold text-gray-900"}," Détails Timelapse "),t("p",{class:"text-gray-600"},` Modifiez le texte "Qu'est-ce qu'un timelapse ?" et les images. `)],-1)),t("div",B,[e[6]||(e[6]=t("div",{class:"bg-gradient-to-r from-blue-600 to-indigo-700 p-6 text-white"},[t("h2",{class:"text-xl font-bold"},"Contenu de la section")],-1)),t("div",E,[t("div",null,[e[2]||(e[2]=t("label",{class:"mb-2 block font-bold text-gray-700"},"Titre Principal",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.title=s),type:"text",class:"w-full rounded-lg border p-3 text-gray-600",placeholder:"Entrez le titre principal"},null,512),[[b,l.value.title]])]),t("div",null,[e[3]||(e[3]=t("label",{class:"mb-2 block font-bold text-gray-700"},"Description",-1)),f(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.description=s),rows:"6",class:"w-full rounded-lg border p-3 text-gray-600",placeholder:"Entrez la description"},null,512),[[b,l.value.description]])]),t("div",null,[t("div",M,[e[4]||(e[4]=t("label",{class:"block font-bold text-gray-700"},"Images Flottantes",-1)),l.value.images.length<6?(o(),n("button",{key:0,onClick:w,type:"button",class:"rounded bg-green-500 px-3 py-1 text-sm text-white hover:bg-green-600"}," Ajouter Image ")):p("",!0)]),t("div",T,[(o(!0),n(L,null,$(l.value.images,(s,i)=>(o(),n("div",{key:i,class:"space-y-2"},[t("div",V,[s?(o(),n("img",{key:0,src:s,class:"h-full w-full object-cover"},null,8,A)):(o(),n("div",U," Aucune image ")),s?(o(),n("button",{key:2,onClick:u=>y(i),type:"button",class:"absolute top-2 right-2 rounded-full bg-red-500 p-1 text-white opacity-0 transition-opacity group-hover:opacity-100 hover:bg-red-600"},[...e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])],8,q)):p("",!0)]),t("div",N,[t("input",{type:"file",onChange:u=>x(u,i),class:"w-full text-sm",accept:"image/*"},null,40,R),l.value.images.length>1?(o(),n("button",{key:0,onClick:u=>_(i),type:"button",class:"rounded bg-red-500 px-2 py-1 text-xs text-white hover:bg-red-600"}," Suppr. ",8,W)):p("",!0)]),t("span",P,"Image "+v(i+1),1)]))),128))])]),t("div",Q,[r.value?(o(),n("span",{key:0,class:j(["font-bold",r.value.includes("✅")?"text-green-600":"text-red-600"])},v(r.value),3)):p("",!0),t("button",{onClick:k,disabled:c.value,class:"rounded-lg bg-blue-600 px-6 py-3 font-bold text-white hover:bg-blue-700 disabled:opacity-50"},v(c.value?"Enregistrement...":"Sauvegarder"),9,G)])])])])])]),_:1}))}};export{O as default};
